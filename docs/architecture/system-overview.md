# 병원 EMR 연계 백엔드 서버 포트폴리오 가이드

## Part 1: 프로젝트 개요 및 시스템 아키텍처

---

## 1. 프로젝트 개요

### 1.1 이 프로젝트를 만드는 이유

병원 전산직은 단순히 "코딩을 잘하는 사람"을 뽑는 것이 아닙니다. 병원에서 요구하는 핵심 역량:

- **의료 데이터 흐름에 대한 이해**: 환자 정보가 어디서 생성되어 어디로 흘러가는지
- **보안과 접근 통제**: 누가 어떤 정보에 접근할 수 있는지 통제
- **감사 추적**: 모든 행위에 대한 기록과 추적 가능성
- **시스템 연동**: EMR, OCS, PACS, LIS 등 다양한 시스템 간 데이터 교환
- **장애 대응**: 24시간 운영되는 의료 시스템의 안정성 확보

### 1.2 프로젝트 범위

```
포함하는 것:
├── 환자 관리 모듈
├── 진료 기록 관리 모듈
├── 처방 관리 모듈
├── 검사 결과 연계 모듈
├── 의료진 계정 관리 모듈
├── 역할 기반 접근 제어 시스템
├── 감사 로그 시스템
├── 외부 시스템 연계 시뮬레이터
└── 운영 문서 및 장애 대응 매뉴얼

포함하지 않는 것:
├── 프론트엔드 UI (최소한만 구현)
├── 실제 의료 장비 연동
├── 실제 보험 청구 시스템
└── 실시간 모니터링 대시보드 (선택 사항)
```

### 1.3 기술 스택

**Option A: Java 기반 (권장)**
```
Backend Framework: Spring Boot 3.x
Database: PostgreSQL 15+
ORM: JPA/Hibernate
Authentication: Spring Security + JWT
API Documentation: Springdoc OpenAPI (Swagger)
Build Tool: Gradle
Testing: JUnit 5 + Mockito
Logging: Logback + SLF4J
```

**Option B: C# 기반**
```
Backend Framework: ASP.NET Core 7+
Database: SQL Server 또는 PostgreSQL
ORM: Entity Framework Core
Authentication: ASP.NET Identity + JWT
API Documentation: Swashbuckle (Swagger)
Testing: xUnit + Moq
Logging: Serilog
```

**공통 인프라**
```
Containerization: Docker + Docker Compose
Version Control: Git
API Testing: Postman Collection 제공
```

### 1.4 디렉토리 구조

```
medicore-hospital-backend/
├── README.md                          # 프로젝트 소개 및 실행 방법
├── docs/                              # 문서화
│   ├── architecture/                  # 아키텍처 문서
│   │   ├── system-overview.md
│   │   ├── data-flow.md
│   │   └── security-design.md
│   ├── database/                      # DB 설계 문서
│   │   ├── erd.png
│   │   ├── table-definitions.md
│   │   └── data-dictionary.md
│   ├── api/                           # API 문서
│   │   └── api-specification.md
│   ├── operations/                    # 운영 문서 (매우 중요!)
│   │   ├── deployment-guide.md
│   │   ├── troubleshooting-guide.md
│   │   ├── backup-recovery.md
│   │   └── incident-response.md
│   └── interview-prep/                # 면접 대비
│       └── expected-questions.md
├── src/
│   └── main/
│       ├── java/com/medicore/
│       │   ├── MedicoreApplication.java
│       │   ├── config/                # 설정 클래스
│       │   ├── domain/                # 도메인 엔티티
│       │   ├── repository/            # 데이터 접근 계층
│       │   ├── service/               # 비즈니스 로직
│       │   ├── controller/            # API 컨트롤러
│       │   ├── security/              # 보안 관련
│       │   ├── audit/                 # 감사 로그
│       │   ├── integration/           # 외부 연계
│       │   └── exception/             # 예외 처리
│       └── resources/
│           ├── application.yml
│           └── db/migration/          # DB 마이그레이션
├── src/test/                          # 테스트 코드
├── docker/
│   ├── Dockerfile
│   └── docker-compose.yml
├── scripts/
│   ├── init-db.sql                    # 초기 데이터
│   ├── backup.sh                      # 백업 스크립트
│   └── health-check.sh                # 헬스체크 스크립트
└── postman/
    └── MediCore-API-Collection.json   # API 테스트 컬렉션
```

---

## 2. 병원 전산 환경 이해

### 2.1 병원 정보 시스템 구성

```
┌─────────────────────────────────────────────────────────────────┐
│                        병원 정보 시스템 (HIS)                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │     EMR     │◄──►│     OCS     │◄──►│    PACS     │         │
│  │ 전자의무기록  │    │  처방전달    │    │  영상저장    │         │
│  └──────┬──────┘    └──────┬──────┘    └──────┬──────┘         │
│         │                  │                  │                 │
│         ▼                  ▼                  ▼                 │
│  ┌─────────────────────────────────────────────────────┐       │
│  │                  통합 데이터베이스                      │       │
│  └─────────────────────────────────────────────────────┘       │
│         │                  │                  │                 │
│         ▼                  ▼                  ▼                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │     LIS     │    │     RIS     │    │   원무/수납   │         │
│  │  검사정보    │    │  영상판독    │    │   시스템     │         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**각 시스템의 역할**

| 시스템 | 정식 명칭 | 주요 기능 |
|--------|----------|----------|
| EMR | Electronic Medical Record | 전자의무기록 저장/조회 |
| OCS | Order Communication System | 처방 전달 및 실행 |
| PACS | Picture Archiving and Communication System | 의료 영상 저장/전송 |
| LIS | Laboratory Information System | 검사실 정보 관리 |
| RIS | Radiology Information System | 영상의학과 업무 관리 |

### 2.2 의료 데이터의 특수성

**왜 의료 데이터가 특별한가?**

1. **법적 보존 의무**: 의료법에 따라 진료기록은 최소 10년 보존
2. **민감 정보**: 개인정보보호법상 민감정보로 분류
3. **생명과 직결**: 잘못된 데이터는 환자 생명에 영향
4. **감사 대상**: 건강보험심사평가원, 의료기관 인증 평가 대상
5. **무결성 필수**: 한 번 기록된 내용은 수정 시에도 이력 보존

**의료법 관련 조항 (면접 필수 암기)**

```
의료법 제22조 (진료기록부 등)
- 의료인은 진료기록부 등을 비치하고 환자의 주된 증상,
  진단 및 치료 내용 등을 상세히 기록하고 서명하여야 한다.

의료법 제23조 (전자의무기록)
- 전자의무기록은 전자서명법에 따른 전자서명이 있어야 한다.
- 전자의무기록을 안전하게 관리·보존하는 데 필요한 시설과 장비를 갖추어야 한다.

의료법 시행규칙 제15조 (진료기록부 등의 보존)
- 환자 명부: 5년
- 진료기록부: 10년
- 처방전: 2년
- 수술기록: 10년
- 검사소견기록: 5년
```

### 2.3 병원 전산직의 실제 업무

**일상적 업무**
- 시스템 모니터링 및 장애 대응
- 사용자 계정 관리 (의사, 간호사 등)
- 권한 설정 및 변경
- 데이터 백업 확인
- 외부 시스템 연계 오류 처리
- 검사 장비 인터페이스 관리

**주기적 업무**
- 보안 패치 적용
- DB 성능 튜닝
- 로그 분석 및 보고
- 재해복구 훈련
- 의료기관 인증 대비 자료 준비

---

## 3. 시스템 아키텍처 설계

### 3.1 전체 시스템 구성도

```
┌────────────────────────────────────────────────────────────────────────┐
│                           MediCore Hospital Backend                     │
├────────────────────────────────────────────────────────────────────────┤
│                                                                        │
│   ┌──────────────────────────────────────────────────────────────┐    │
│   │                      API Gateway Layer                        │    │
│   │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │    │
│   │  │   인증/인가   │  │  Rate Limit │  │  Request    │          │    │
│   │  │   Filter    │  │   Filter    │  │  Logging    │          │    │
│   │  └─────────────┘  └─────────────┘  └─────────────┘          │    │
│   └──────────────────────────────────────────────────────────────┘    │
│                                    │                                   │
│   ┌────────────────────────────────▼─────────────────────────────┐    │
│   │                      Service Layer                            │    │
│   │                                                               │    │
│   │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │    │
│   │  │   Patient   │  │  Medical    │  │ Prescription│          │    │
│   │  │   Service   │  │  Record Svc │  │   Service   │          │    │
│   │  └─────────────┘  └─────────────┘  └─────────────┘          │    │
│   │                                                               │    │
│   │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │    │
│   │  │    Lab      │  │    User     │  │   Audit     │          │    │
│   │  │   Service   │  │   Service   │  │   Service   │          │    │
│   │  └─────────────┘  └─────────────┘  └─────────────┘          │    │
│   └──────────────────────────────────────────────────────────────┘    │
│                                    │                                   │
│   ┌────────────────────────────────▼─────────────────────────────┐    │
│   │                      Data Access Layer                        │    │
│   │  ┌─────────────────────────────────────────────────────┐     │    │
│   │  │                   JPA Repositories                   │     │    │
│   │  └─────────────────────────────────────────────────────┘     │    │
│   └──────────────────────────────────────────────────────────────┘    │
│                                    │                                   │
│   ┌────────────────────────────────▼─────────────────────────────┐    │
│   │                      Database Layer                           │    │
│   │  ┌─────────────────┐          ┌─────────────────┐            │    │
│   │  │   PostgreSQL    │          │   Audit Log DB  │            │    │
│   │  │   (Main DB)     │          │   (분리 저장)    │            │    │
│   │  └─────────────────┘          └─────────────────┘            │    │
│   └──────────────────────────────────────────────────────────────┘    │
│                                                                        │
│   ┌──────────────────────────────────────────────────────────────┐    │
│   │                   External Integration Layer                  │    │
│   │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │    │
│   │  │  Lab Device │  │  Insurance  │  │   Other     │          │    │
│   │  │  Interface  │  │  Interface  │  │  Hospital   │          │    │
│   │  │   (Mock)    │  │   (Mock)    │  │   (Mock)    │          │    │
│   │  └─────────────┘  └─────────────┘  └─────────────┘          │    │
│   └──────────────────────────────────────────────────────────────┘    │
│                                                                        │
└────────────────────────────────────────────────────────────────────────┘
```

### 3.2 레이어별 책임

**API Gateway Layer**
```
책임:
- 모든 요청의 진입점
- 인증 토큰 검증 (JWT)
- 권한 확인 (RBAC)
- 요청/응답 로깅
- Rate Limiting

구현 컴포넌트:
- JwtAuthenticationFilter
- RoleAuthorizationFilter
- RequestLoggingFilter
- GlobalExceptionHandler
```

**Service Layer**
```
책임:
- 비즈니스 로직 처리
- 트랜잭션 관리
- 도메인 규칙 검증
- 감사 이벤트 발행

구현 컴포넌트:
- PatientService
- MedicalRecordService
- PrescriptionService
- LabResultService
- UserService
- AuditService
```

**Data Access Layer**
```
책임:
- 데이터베이스 접근 추상화
- 쿼리 최적화
- 엔티티-테이블 매핑
```

**External Integration Layer**
```
책임:
- 외부 시스템과의 통신
- 메시지 포맷 변환 (HL7, JSON)
- 연결 실패 시 재시도 로직
- 연계 로그 기록
```

### 3.3 데이터 흐름도

**진료 기록 생성 흐름**
```
[의사 클라이언트]
      │
      ▼ (1) POST /api/medical-records
┌─────────────────┐
│ JwtAuthFilter   │──► 토큰 검증 실패 → 401 Unauthorized
└────────┬────────┘
         │ (2) 토큰 유효
         ▼
┌─────────────────┐
│ RoleAuthFilter  │──► 권한 부족 → 403 Forbidden
└────────┬────────┘
         │ (3) 의사 권한 확인
         ▼
┌─────────────────┐
│ MedicalRecord   │
│   Controller    │
└────────┬────────┘
         │ (4) 요청 데이터 검증
         ▼
┌─────────────────┐
│ MedicalRecord   │
│    Service      │
└────────┬────────┘
         │ (5) 비즈니스 로직
         │     - 환자 존재 확인
         │     - 진료 기록 생성
         │     - 감사 로그 발행
         ▼
┌─────────────────┐
│   Repository    │
└────────┬────────┘
         │ (6) DB 저장
         ▼
┌─────────────────┐  ┌─────────────────┐
│   Main DB       │  │  Audit Log DB   │
│ (진료기록 저장)   │  │  (접근 이력 저장) │
└─────────────────┘  └─────────────────┘
```

### 3.4 보안 아키텍처

```
┌─────────────────────────────────────────────────────────────────┐
│                       Security Architecture                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                    Authentication Layer                    │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐       │ │
│  │  │   Login     │  │    JWT      │  │   Token     │       │ │
│  │  │  Service    │  │  Provider   │  │  Validator  │       │ │
│  │  └─────────────┘  └─────────────┘  └─────────────┘       │ │
│  └───────────────────────────────────────────────────────────┘ │
│                              │                                  │
│  ┌───────────────────────────▼───────────────────────────────┐ │
│  │                    Authorization Layer                     │ │
│  │  ┌─────────────────────────────────────────────────────┐  │ │
│  │  │                RBAC (Role-Based Access Control)      │  │ │
│  │  │                                                      │  │ │
│  │  │  DOCTOR ──────► 진료기록 CRUD, 처방 생성, 검사 조회   │  │ │
│  │  │  NURSE ───────► 진료기록 조회, 처방 조회, 환자 관리   │  │ │
│  │  │  ADMIN ───────► 환자 등록, 수납, 예약 관리           │  │ │
│  │  │  IT_ADMIN ────► 계정 관리, 감사 로그 조회, 시스템 설정│  │ │
│  │  └─────────────────────────────────────────────────────┘  │ │
│  └───────────────────────────────────────────────────────────┘ │
│                              │                                  │
│  ┌───────────────────────────▼───────────────────────────────┐ │
│  │                      Audit Layer                           │ │
│  │  ┌─────────────────────────────────────────────────────┐  │ │
│  │  │              All Access Logged                       │  │ │
│  │  │  WHO + WHEN + WHAT + WHERE + RESULT                 │  │ │
│  │  └─────────────────────────────────────────────────────┘  │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```
